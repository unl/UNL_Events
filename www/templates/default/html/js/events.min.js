let progress=document.createElement("progress"),lastLocation=window.location;document.addEventListener("DOMContentLoaded",()=>{let r=document.querySelector("link[rel=home]"),o=document.querySelector(".wp-calendar");var e=null;let l="day",c=null,s=null,t=null,n=document.getElementById("heading-date");function d(e,t){window.history.pushState&&window.location.href!==e&&window.history.pushState({route:t},"",e)}function u(){c=new Date(o.dataset.datetime);var t=new Date,e=c.getMonth(),n=c.getFullYear(),a=o.querySelectorAll("td");a.forEach(e=>{e.classList.remove("today","active")}),n===t.getFullYear()&&e===t.getMonth()&&a.forEach(e=>{e.classList.contains("prev")||e.classList.contains("next")||e.innerText.trim()==t.getDate()&&e.classList.add("today")}),n==s.getFullYear()&&e==s.getMonth()&&a.forEach(e=>{e.classList.contains("prev")||e.classList.contains("next")||e.innerText.trim()==s.getDate()&&e.classList.add("active")})}function i(e){h(),progress.classList.remove("dcf-d-none!"),t=setTimeout(function(){e.prepend(progress),progress.classList.remove("dcf-d-none!")},1e3)}function h(){clearTimeout(t)}function g(){var e;s=null!==n?(e=n.dataset.datetime,new Date(e)):new Date}function f(e){let t=null,n=document.querySelector("aside .calendar");t=e instanceof Date?r+e.getFullYear()+"/"+(e.getMonth()+1)+"/":e,i(n),fetch(t+"?monthwidget&format=hcalendar").then(e=>e.text()).then(e=>{h(),n.innerHTML=e,o=document.querySelector(".wp-calendar"),u()})}function m(e){let t=new Date,n=null,a=document.getElementById("updatecontent");d(n=e instanceof Date?r+e.getFullYear()+"/"+(e.getMonth()+1)+"/"+e.getDate()+"/":e,"day");e="format=hcalendar";"?"===n.charAt(n.length-1)?n+=e:n=0<n.indexOf("?")?n+"&"+e:n+"?"+e,i(a),fetch(n).then(e=>e.text()).then(e=>{h(),a.innerHTML=e,g(),s.getFullYear()==t.getFullYear()&&s.getMonth()==t.getMonth()&&s.getDate()==t.getDate()&&(window.location=window.location),c.getFullYear()!==s.getFullYear()||c.getMonth()!==s.getMonth()?f(s):u(),s.getFullYear()!=t.getFullYear()&&s.getMonth()!=t.getMonth()&&s.getDate()!=t.getDate()&&document.getElementById("events-promo-bar").classList.add("dcf-d-none!")})}function v(e){let t=document.getElementById("updatecontent");d(e,"event"),i(t),fetch(e+"?format=hcalendar").then(e=>e.text()).then(e=>{h(),t.innerHTML=e})}function a(e,t){var n=new Date(e);return n.setMonth(n.getMonth()+t),n.getDate()<e.getDate()&&n.setDate(0),n}r=r?r.href:"/",null!==(e=document.querySelector("aside .calendar"))&&(g(),u(),e.addEventListener("click",e=>{var t=e.target.closest("a");t&&(t.closest("td")?(e.preventDefault(),m(t.href)):(t.classList.contains("next")||t.classList.contains("prev"))&&(e.preventDefault(),f(t.href)))},!0));var e=document.querySelector(".view-unl_ucbcn_frontend_eventinstance"),w=document.querySelector(".view-unl_ucbcn_frontend_search"),e=(null!==e?l="event":null!==w&&(l="search"),document.addEventListener("keyup",t=>{if(!["INPUT","SELECT","TEXTAREA","BUTTON"].includes(t.target.tagName)){var n=document.querySelector(".day-nav");if(null!==n){let e=null;switch(t.code){case"ArrowRight":e=n.querySelector(".next").href,m(e=t.altKey?a(s,1):e);break;case"ArrowLeft":e=n.querySelector(".prev").href,m(e=t.altKey?a(s,-1):e)}}}}),document.getElementById("updatecontent"));null!==e&&e.addEventListener("click",e=>{var t=e.target.closest("a.summary");null!==t&&t.closest(".vevent")&&(e.preventDefault(),v(t.href))},!0),window.addEventListener("popstate",e=>{var t=e.state,n=window.location.href;if(t)switch(t.route||l){case"event":v(n);break;case"day":m(n);break;case"search":{var a=n;let t=document.getElementById("updatecontent");d(a,"search"),i(t),fetch(a+(-1==a.indexOf("?")?"?":"&")+"format=hcalendar").then(e=>e.text()).then(e=>{h(),t.innerHTML=e})}}else e.preventDefault()})});