require(["jquery","wdn"],function(m,p){"use strict";var D=m("<progress>"),M="(min-width: 768px)";window.location;m(function(){var t,r,i,e,c=m("link[rel=home]"),n=m("#script_main"),o=m(".wp-calendar"),a="day";function l(t,e){window.history.pushState&&window.location.href!==t&&window.history.pushState({route:e},"",t)}function u(){r=new Date(o.data("datetime"));var t=new Date,e=r.getMonth(),n=r.getFullYear(),a=m("td",o);a.removeClass("today active"),n===t.getFullYear()&&e===t.getMonth()&&a.not(".prev,.next").each(function(){if(m.trim(m(this).text())==t.getDate())return m(this).addClass("today"),!1}),n==i.getFullYear()&&e==i.getMonth()&&a.not(".prev,.next").each(function(){if(m.trim(m(this).text())==i.getDate())return m(this).addClass("active"),!1})}function h(t){s(),D.hide(),e=setTimeout(function(){D.prependTo(t),D.fadeIn(200)},1e3)}function s(){clearTimeout(e)}function d(){var t=m("h1").data("datetime");i=t?new Date(t):new Date}function f(t){var e,n=m("aside .calendar");e=t instanceof Date?c+t.getFullYear()+"/"+(t.getMonth()+1)+"/":t,h(n),m.get(e+"?monthwidget&format=hcalendar",function(t){s(),n.html(t),o=m(".wp-calendar"),u()})}function g(t){var e,n=new Date,a=m("#updatecontent");l(e=t instanceof Date?c+t.getFullYear()+"/"+(t.getMonth()+1)+"/"+t.getDate()+"/":t,"day");var o="format=hcalendar";"?"===e.charAt(e.length-1)?e+=o:e=0<e.indexOf("?")?e+"&"+o:e+"?"+o,h(a),m.get(e,function(t){s(),a.html(t),d(),i.getFullYear()==n.getFullYear()&&i.getMonth()==n.getMonth()&&i.getDate()==n.getDate()&&(window.location=window.location),r.getFullYear()!==i.getFullYear()||r.getMonth()!==i.getMonth()?f(i):u(),i.getFullYear()!=n.getFullYear()&&i.getMonth()!=n.getMonth()&&i.getDate()!=n.getDate()&&m("#events-promo-bar").hide()})}function v(t){var e=m("#updatecontent");l(t,"event"),h(e),m.get(t+"?format=hcalendar",function(t){s(),e.html(t)})}function w(t,e){var n=new Date(t);return n.setMonth(n.getMonth()+e),n.getDate()<t.getDate()&&n.setDate(0),n}c=c.length?c[0].href:"/",n=n.length?p.toAbs("./",n[0].src):"/templates/default/html/js/",(t=m("aside .calendar")).length&&(d(),u(),t.on("click","td a",function(t){t.preventDefault(),g(this.href)}),t.on("click","a.next, a.prev",function(t){t.preventDefault(),f(this.href)})),m(".view-unl_ucbcn_frontend_eventinstance").length?a="event":m(".view-unl_ucbcn_frontend_search").length&&(a="search"),m(document).on("keyup",function(t){if(!m(t.target).is("input, select, textarea, button")){var e=m(".day-nav");if(e.length)switch(t.which){case 39:g(t.altKey?w(i,1):m(".next",e).attr("href"));break;case 37:g(t.altKey?w(i,-1):m(".prev",e).attr("href"))}}}),m("#updatecontent").on("click",".vevent a.summary",function(t){t.preventDefault(),v(this.href)}),m(window).on("popstate",function(t){var e=t.originalEvent.state&&t.originalEvent.state.route||a,n=window.location.href;if(null===t.originalEvent.state)return event.preventDefault(),!1;switch(e){case"event":v(n);break;case"day":g(n);break;case"search":!function(t){var e=m("#updatecontent");l(t,"search"),h(e),m.get(t+(-1==t.indexOf("?")?"?":"&")+"format=hcalendar",function(t){s(),e.html(t)})}(n)}}),m(window).on("resize",function(){window.matchMedia(M).matches})})});