require.config({paths:{cropperjs:"/js/cropperjs"}}),require(["dcf-modal","cropperjs/cropper.min","css!cropperjs/cropper.min.css"],function(e,t){function a(e){var t;i="image/jpeg"===e.type?e.type:"image/png",FileReader&&((t=new FileReader).onload=function(e){!function(e){r.src=e,f.openModal("image-modal")}(t.result)},t.readAsDataURL(e))}var n,i,o=document.getElementById("cropper-errors"),d=document.getElementById("cropper-content"),r=document.getElementById("source-image"),c=document.getElementById("cropped-image-container"),m=document.getElementById("cropped-image"),l=document.getElementById("cropped-image-data"),p=document.getElementById("imagedata"),g=document.getElementById("image-modal"),s=document.getElementById("cancel-crop-btn"),u=document.getElementById("crop-btn"),f=e?new e.DCFModal([]):new DCFModal([]),v=[];p.addEventListener("change",function(e){var t=e.target.files;if(t&&0<t.length){var n=t[0];!function(e){switch(v=[],e.type){case"image/png":case"image/jpeg":case"image/gif":case"image/avif":case"image/webp":break;default:v.push("Invalid file type ("+e.type+").  Allowed types: avif, gif, jpeg, png and webp.")}if(8388608<e.size){var t=e.size/1024/1024;v.push("File size ("+t.toFixed(2)+" MB) over limit of 8 MB.")}return 0===v.length}(n)?(o.innerHTML="",v.forEach(function(e){var t=document.createElement("LI");t.innerText=e,o.append(t)}),o.removeAttribute("hidden"),d.setAttribute("hidden",""),f.openModal("image-modal")):a(n)}}),s.addEventListener("click",function(e){f.closeModal("image-modal")}),u.addEventListener("click",function(e){n.getCroppedCanvas({minWidth:150,minHeight:150,maxWidth:4096,maxHeight:4096,fillColor:"#fff",imageSmoothingEnabled:!0,imageSmoothingQuality:"high"}).toBlob(function(e){var t=new FileReader;t.readAsDataURL(e),t.onloadend=function(){var e=t.result;m.setAttribute("src",e),c.removeAttribute("hidden"),l.value=e,f.closeModal("image-modal")}},i,.9)}),document.addEventListener("ModalOpenEvent_"+g.id,function(e){n=new t(r,{aspectRatio:1,viewMode:2,autoCropArea:1,preview:".preview-image"})}),document.addEventListener("ModalCloseEvent_"+g.id,function(e){p.value="",n.destroy(),n=null})});