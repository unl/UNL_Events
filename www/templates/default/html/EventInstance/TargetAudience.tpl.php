<?php
    // Gets the event and audience
    $event = $context->eventdatetime->getEvent();
    $event_target_audience = $event->getAudiences();
?>

<?php if (isset($event_target_audience) && count($event_target_audience) > 0): ?>
<span class="target-audience">
    <svg
        class="dcf-h-4 dcf-w-4 dcf-fill-current"
        aria-hidden="true"
        focusable="false"
        height="24"
        width="24"
        viewBox="0 0 24 24"
    >
        <path d="M10.5,13.663V12.28c0.371-0.286,0.917-0.953,0.991-2.43c0.417-0.277,0.655-0.895,0.655-1.498 c0-0.334-0.076-0.631-0.22-0.859c-0.068-0.11-0.151-0.202-0.246-0.276c0.22-0.513,0.541-1.394,0.305-2.338 C11.638,3.492,9.891,3,8.5,3C7.261,3,5.739,3.39,5.177,4.456c-0.464-0.027-0.795,0.108-1.02,0.383 C3.646,5.464,4.055,6.492,4.356,7.205C4.253,7.281,4.162,7.378,4.088,7.494C3.938,7.728,3.859,8.03,3.859,8.369 c0,0.596,0.236,1.207,0.65,1.481c0.075,1.477,0.62,2.144,0.991,2.43v1.382C3.624,14.427,0,16.03,0,17v4.5 C0,21.776,0.224,22,0.5,22h15c0.276,0,0.5-0.224,0.5-0.5V17C16,16.03,12.376,14.427,10.5,13.663z M15,21H1v-3.896 c0.387-0.428,2.605-1.608,5.186-2.64C6.375,14.388,6.5,14.205,6.5,14v-2c0-0.196-0.137-0.383-0.315-0.464 C6.178,11.532,5.5,11.204,5.5,9.5c0-0.276-0.165-0.485-0.44-0.485C4.945,8.936,4.789,8.453,4.892,8.121C4.929,8,4.96,8,5,8 c0.133,0,0.26-0.053,0.354-0.146S5.5,7.633,5.5,7.5c0-0.159-0.064-0.311-0.191-0.611c-0.42-0.991-0.437-1.319-0.383-1.411 C4.926,5.476,5.029,5.414,5.4,5.49c0.26,0.052,0.52-0.109,0.585-0.369C6.147,4.472,7.205,4,8.5,4s2.353,0.472,2.515,1.121 c0.181,0.725-0.135,1.435-0.323,1.86c-0.1,0.224-0.16,0.36-0.16,0.519c0,0.276,0.253,0.503,0.53,0.503 c0.021,0.015,0.082,0.12,0.084,0.336C11.15,8.684,11.012,8.965,11,9c-0.276,0-0.5,0.224-0.5,0.5c0,1.693-0.669,2.028-0.665,2.028 C9.634,11.598,9.5,11.788,9.5,12v2c0,0.205,0.125,0.388,0.314,0.465c2.58,1.031,4.799,2.212,5.186,2.64V21z"></path>
        <path d="M20.935,15.188c-0.471-0.169-0.962-0.346-1.435-0.528v-0.858c0.373-0.248,0.907-0.804,0.989-1.984 c0.338-0.285,0.513-0.864,0.513-1.438c0-0.225-0.029-0.552-0.17-0.834C20.786,9.453,20.73,9.371,20.667,9.3 c0.245-0.445,0.568-1.175,0.307-1.958C20.613,6.259,19.146,5.875,18,5.875c-1.001,0-2.247,0.293-2.787,1.088 c-0.369-0.009-0.677,0.105-0.88,0.344c-0.444,0.525-0.166,1.369,0.049,1.935c-0.086,0.08-0.161,0.179-0.22,0.294 c-0.145,0.281-0.175,0.607-0.175,0.833c0,0.58,0.178,1.166,0.523,1.451c0.083,1.178,0.617,1.733,0.989,1.981V14.5 c0,0.276,0.224,0.5,0.5,0.5s0.5-0.224,0.5-0.5v-1c0-0.212-0.15-0.407-0.351-0.477C16.123,13.014,15.5,12.78,15.5,11.5 c0-0.234-0.16-0.431-0.377-0.484C14.978,10.794,14.929,10.124,15,10c0.276,0,0.5-0.224,0.5-0.5c0-0.137-0.048-0.263-0.137-0.492 c-0.225-0.584-0.312-0.944-0.291-1.034c0-0.001,0.08-0.034,0.328,0.016c0.247,0.051,0.495-0.091,0.574-0.332 c0.149-0.446,1.02-0.783,2.026-0.783s1.877,0.337,2.025,0.783c0.161,0.482-0.148,1.015-0.333,1.333 C19.577,9.191,19.5,9.323,19.5,9.5c0,0.276,0.147,0.468,0.423,0.468c0.13,0.151,0.091,0.825-0.049,1.048 C19.659,11.072,19.5,11.268,19.5,11.5c0,1.28-0.623,1.514-0.635,1.519C18.649,13.079,18.5,13.276,18.5,13.5V15 c0,0.205,0.125,0.388,0.314,0.465c0.576,0.23,1.193,0.452,1.782,0.664c0.89,0.32,2.089,0.752,2.404,0.997V21h-5 c-0.276,0-0.5,0.224-0.5,0.5S17.724,22,18,22h5.5c0.276,0,0.5-0.224,0.5-0.5V17C24,16.318,23.115,15.973,20.935,15.188z"></path>
        <g>
            <path fill="none" d="M0 0H24V24H0z"></path>
        </g>
    </svg>
    <span class="dcf-sr-only">Target Audiences:</span>
    <div>
        <?php
            $output = "";
            foreach ($event_target_audience as $index => $audience) {
                $current_audience = $audience->getAudience();
                $output .= '<a class="unl-prerender dcf-d-inline-block" href="' .
                    $frontend->getAudienceURL() .
                    '?audience=' .
                    $current_audience->name .
                    '" >';
                $output .= $current_audience->name;
                $output .= '</a>';

                if ($index + 1 < count($event_target_audience)) {
                    $output .= ', ';
                }
            }
            echo $output;
        ?>
    </div>
</span>
<?php endif; ?>
